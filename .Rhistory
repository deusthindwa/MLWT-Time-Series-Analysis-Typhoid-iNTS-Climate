climate.rain = as.xts(climate.rain[,-1,drop = FALSE], order.by = as.Date(climate.rain[,1]))
climate.temp = as.xts(climate.temp[,-1,drop = FALSE], order.by = as.Date(climate.temp[,1]))
#----------monthly mean for rainfall and temperature
climate.rainW <- apply.weekly(climate.rain, FUN = mean)
climate.tempW <- apply.weekly(climate.temp, FUN = mean)
climate.rain <- apply.monthly(climate.rain, FUN = mean)
climate.temp <- apply.monthly(climate.temp, FUN = mean)
#----------create tibbles for case and climate seasonal-adjustment
case.typhi <-tk_tbl(case.typhi, preserve_index = TRUE, rename_index = "date")
case.iNTS <-tk_tbl(case.iNTS, preserve_index = TRUE, rename_index = "date")
climate.rain <-tk_tbl(climate.rain, preserve_index = TRUE, rename_index = "date")
climate.temp <-tk_tbl(climate.temp, preserve_index = TRUE, rename_index = "date")
#----------seasonally-adjusted cases and climate
case.iNTS.ts <- ts(na.omit(case.iNTS$case_count), frequency = 12)
trend_n <-tk_tbl(exp(seasadj(mstl(log(case.iNTS.ts)))), preserve_index = FALSE) #multiplicative series (log-transform); already has at least 1 NTS case.
case.iNTS$case_count_sea <- trend_n$value  #seasonally-adjusted cases: trend+remainder
case.iNTS$case_count_sea[case.iNTS$case_count_sea < 0] <- 0
setnames(case.iNTS, old="case_count", new="case_count_obs")
case.typhi.ts <- ts(na.omit(case.typhi$case_count), frequency = 12)
trend_n <-tk_tbl(exp(seasadj(mstl(log(case.typhi.ts+1)))), preserve_index = FALSE) #multiplicative series (log-transform); add 1 since log(0) is not defined.
case.typhi$case_count_sea <- trend_n$value #seasonally-adjusted cases: trend+remainder
case.typhi$case_count_sea[case.typhi$case_count_sea < 0] <- 0
setnames(case.typhi, old="case_count", new="case_count_obs")
climate.rain.ts <- ts(na.omit(climate.rain$rainfall), frequency = 12)
trend_n <-tk_tbl(seasadj(mstl(climate.rain.ts)), preserve_index = FALSE) #additive series
climate.rain$rainfall_sea <- trend_n$value #seasonally-adjusted rainfall: trend+remainder
climate.rain$rainfall_sea[climate.rain$rainfall_sea < 0] <- 0
setnames(climate.rain, old="rainfall", new="rainfall_obs")
climate.temp.ts <- ts(na.omit(climate.temp$temperature), frequency = 12)
trend_n <-tk_tbl(seasadj(mstl(climate.temp.ts)), preserve_index = FALSE) #additive series
climate.temp$temperature_sea <- trend_n$value #seasonally-adjusted temperature: trend+remainder
climate.temp$temperature_sea[climate.temp$temperature_sea < 0] <- 0
setnames(climate.temp, old="temperature", new="temperature_obs")
#----------plot decomposed all series
x<-mstl(case.iNTS.ts,s.window="period") %>% ggfortify:::autoplot.ts(main="A",xlab="Years (2000-2015)",ylab="Number of iNTS cases",size=1,colour="orange2",is.date=FALSE) + theme_bw()
y<-mstl(case.typhi.ts,s.window="periodic") %>% ggfortify:::autoplot.ts(main="B",xlab="Years (2000-2015)",ylab="Number of typhoid cases",size=1,colour="red2",is.date=FALSE) + theme_bw()
z<-mstl(climate.rain.ts,s.window="periodic") %>% ggfortify:::autoplot.ts(main="C",xlab="Years (2000-2015)",ylab="Rainfall (mm)",size=1,colour="blue2",is.date=FALSE) + theme_bw()
v<-mstl(climate.temp.ts,s.window="periodic") %>% ggfortify:::autoplot.ts(main="D",xlab="Years (2000-2015)",ylab="Temperature (°C)",size=1,colour="green2",is.date=FALSE) + theme_bw()
grid.arrange(grobs=list(x,y,z,v), ncol=4, nrow=1)
#----------plot observed vs seasonal-adjusted series
S1<-ggplot(as.data.frame(case.iNTS)) +
geom_line(aes(date, case_count_obs, color="Observed data"), size=0.8) +
geom_line(aes(date, case_count_sea, color="Seasonal-adjusted"), size=0.8) +
scale_color_manual(values = c("Observed data"="black","Seasonal-adjusted"="orange2")) +
labs(title="A", x ="", y = "iNTS cases") +
theme(plot.title = element_text(hjust = 0)) +
theme(axis.title.x = element_text(size = 10)) +
theme(axis.title.y = element_text(size = 10)) +
theme(axis.text.x = element_text(face="bold", size=10), axis.text.y = element_text(face="bold", size=10)) +
theme(legend.justification=c(0.5,0), legend.position = c(0.7,0.7), legend.text = element_text(size = 10), legend.title = element_text(face="bold", size=0)) +
theme(legend.key.height=unit(1,"line")) +
theme(legend.key.width=unit(1,"line"))
S2<-ggplot(as.data.frame(case.typhi)) +
geom_line(aes(date, case_count_obs, color="Observed data"), size=0.8) +
geom_line(aes(date, case_count_sea, color="Seasonal-adjusted"), size=0.8) +
scale_color_manual(values = c("Observed data"="black","Seasonal-adjusted"="red2")) +
labs(title="B", x ="", y = "Typhoid cases") +
theme(plot.title = element_text(hjust = 0)) +
theme(axis.title.x = element_text(size = 10)) +
theme(axis.title.y = element_text(size = 10)) +
theme(axis.text.x = element_text(face="bold", size=10), axis.text.y = element_text(face="bold", size=10)) +
theme(legend.justification=c(0.5,0), legend.position = c(0.3,0.7), legend.text = element_text(size = 10), legend.title = element_text(face="bold", size=0)) +
theme(legend.key.height=unit(1,"line")) +
theme(legend.key.width=unit(1,"line"))
S3<-ggplot(as.data.frame(climate.rain)) +
geom_line(aes(date, rainfall_obs, color="Observed data"), size=0.8) +
geom_line(aes(date, rainfall_sea, color="Seasonal-adjusted"), size=0.8) +
scale_color_manual(values = c("Observed data"="black","Seasonal-adjusted"="blue2")) +
labs(title="C", x ="Year", y = "Rainfall (mm)") +
theme(plot.title = element_text(hjust = 0)) +
theme(axis.title.x = element_text(size = 10)) +
theme(axis.title.y = element_text(size = 10)) +
theme(axis.text.x = element_text(face="bold", size=10), axis.text.y = element_text(face="bold", size=10)) +
theme(legend.justification=c(0.5,0), legend.position = c(0.3,0.7), legend.text = element_text(size = 10), legend.title = element_text(face="bold", size=0)) +
theme(legend.key.height=unit(1,"line")) +
theme(legend.key.width=unit(1,"line"))
S4<-ggplot(as.data.frame(climate.temp)) +
geom_line(aes(date, temperature_obs, color="Observed data"), size=0.8) +
geom_line(aes(date, temperature_sea, color="Seasonal-adjusted"), size=0.8) +
scale_color_manual(values = c("Observed data"="black","Seasonal-adjusted"="green2")) +
labs(title="D", x ="Year", y = "Temperature (°C)") +
theme(plot.title = element_text(hjust = 0)) +
theme(axis.title.x = element_text(size = 10)) +
theme(axis.title.y = element_text(size = 10)) +
theme(axis.text.x = element_text(face="bold", size=10), axis.text.y = element_text(face="bold", size=10)) +
theme(legend.justification=c(0.5,0), legend.position = c(0.3,0.7), legend.text = element_text(size = 10), legend.title = element_text(face="bold", size=0)) +
theme(legend.key.height=unit(1,"line")) +
theme(legend.key.width=unit(1,"line"))
grid.arrange(grobs=list(S1, S2, S3, S4), ncol=2, nrow=2)
rm(list = ls()[grep("^trend_n", ls())])
#----------linear interpolation and extrapolation
census.year <-c(1998, 2008)
census.popn <-c(809397, 1022680)
census.count.1998.2008 <- approx(census.year, census.popn, n=11)
census.count.2009.2015 <- approxExtrap(census.year, census.popn, xout=c(2009, 2010, 2011, 2012, 2013, 2014, 2015))
#----------calculated incidence of monthly iNTS
case.iNTS$census[year(case.iNTS$date)==2000]<- 852054; case.iNTS$census[year(case.iNTS$date)==2001]<-873382
case.iNTS$census[year(case.iNTS$date)==2002]<- 894710; case.iNTS$census[year(case.iNTS$date)==2003]<-916039
case.iNTS$census[year(case.iNTS$date)==2004]<- 937367; case.iNTS$census[year(case.iNTS$date)==2005]<-958695
case.iNTS$census[year(case.iNTS$date)==2006]<- 980023; case.iNTS$census[year(case.iNTS$date)==2007]<-1001352
case.iNTS$census[year(case.iNTS$date)==2008]<-1022680; case.iNTS$census[year(case.iNTS$date)==2009]<-1044008
case.iNTS$census[year(case.iNTS$date)==2010]<-1065337; case.iNTS$census[year(case.iNTS$date)==2011]<-1086665
case.iNTS$census[year(case.iNTS$date)==2012]<-1107993; case.iNTS$census[year(case.iNTS$date)==2013]<-1129322
case.iNTS$census[year(case.iNTS$date)==2014]<-1150650; case.iNTS$census[year(case.iNTS$date)==2015]<-1171978
case.iNTS$incid_sea <-case.iNTS$case_count_sea*100000/case.iNTS$census
case.iNTS$incid_obs <-case.iNTS$case_count_obs*100000/case.iNTS$census
#----------calculated incidence of monthly typhoid
case.typhi$census[year(case.typhi$date)==2000]<- 852054; case.typhi$census[year(case.typhi$date)==2001]<-873382
case.typhi$census[year(case.typhi$date)==2002]<- 894710; case.typhi$census[year(case.typhi$date)==2003]<-916039
case.typhi$census[year(case.typhi$date)==2004]<- 937367; case.typhi$census[year(case.typhi$date)==2005]<-958695
case.typhi$census[year(case.typhi$date)==2006]<- 980023; case.typhi$census[year(case.typhi$date)==2007]<-1001352
case.typhi$census[year(case.typhi$date)==2008]<-1022680; case.typhi$census[year(case.typhi$date)==2009]<-1044008
case.typhi$census[year(case.typhi$date)==2010]<-1065337; case.typhi$census[year(case.typhi$date)==2011]<-1086665
case.typhi$census[year(case.typhi$date)==2012]<-1107993; case.typhi$census[year(case.typhi$date)==2013]<-1129322
case.typhi$census[year(case.typhi$date)==2014]<-1150650; case.typhi$census[year(case.typhi$date)==2015]<-1171978
case.typhi$incid_sea <-case.typhi$case_count_sea*100000/case.typhi$census
case.typhi$incid_obs <-case.typhi$case_count_obs*100000/case.typhi$census
case.iNTSW <-tk_tbl(case.iNTSW, preserve_index = TRUE, rename_index = "date")
case.iNTSW$census[year(case.iNTSW$date)==2000]<- 852054; case.iNTSW$census[year(case.iNTSW$date)==2001]<-873382
case.iNTSW$census[year(case.iNTSW$date)==2002]<- 894710; case.iNTSW$census[year(case.iNTSW$date)==2003]<-916039
case.iNTSW$census[year(case.iNTSW$date)==2004]<- 937367; case.iNTSW$census[year(case.iNTSW$date)==2005]<-958695
case.iNTSW$census[year(case.iNTSW$date)==2006]<- 980023; case.iNTSW$census[year(case.iNTSW$date)==2007]<-1001352
case.iNTSW$census[year(case.iNTSW$date)==2008]<-1022680; case.iNTSW$census[year(case.iNTSW$date)==2009]<-1044008
case.iNTSW$census[year(case.iNTSW$date)==2010]<-1065337; case.iNTSW$census[year(case.iNTSW$date)==2011]<-1086665
case.iNTSW$census[year(case.iNTSW$date)==2012]<-1107993; case.iNTSW$census[year(case.iNTSW$date)==2013]<-1129322
case.iNTSW$census[year(case.iNTSW$date)==2014]<-1150650; case.iNTSW$census[year(case.iNTSW$date)==2015]<-1171978
case.iNTSW$incid_obs <-case.iNTSW$case_count*100000/case.iNTSW$census
case.typhiW <-tk_tbl(case.typhiW, preserve_index = TRUE, rename_index = "date")
case.typhiW$census[year(case.typhiW$date)==2000]<- 852054; case.typhiW$census[year(case.typhiW$date)==2001]<-873382
case.typhiW$census[year(case.typhiW$date)==2002]<- 894710; case.typhiW$census[year(case.typhiW$date)==2003]<-916039
case.typhiW$census[year(case.typhiW$date)==2004]<- 937367; case.typhiW$census[year(case.typhiW$date)==2005]<-958695
case.typhiW$census[year(case.typhiW$date)==2006]<- 980023; case.typhiW$census[year(case.typhiW$date)==2007]<-1001352
case.typhiW$census[year(case.typhiW$date)==2008]<-1022680; case.typhiW$census[year(case.typhiW$date)==2009]<-1044008
case.typhiW$census[year(case.typhiW$date)==2010]<-1065337; case.typhiW$census[year(case.typhiW$date)==2011]<-1086665
case.typhiW$census[year(case.typhiW$date)==2012]<-1107993; case.typhiW$census[year(case.typhiW$date)==2013]<-1129322
case.typhiW$census[year(case.typhiW$date)==2014]<-1150650; case.typhiW$census[year(case.typhiW$date)==2015]<-1171978
case.typhiW$incid_obs <-case.typhiW$case_count*100000/case.typhiW$census
View(case.iNTSW)
View(case.typhiW)
j <- seq(from=1, to=53, by=4)
i <- seq(from=1, to=12, by=1)
pox1 <- ggplot(subset(case.iNTSW, year(date)<2011), aes(x=week(date), y=case_count))  +
geom_boxplot(aes( group=week(date)),color="tan4", fill="tan4", alpha=0.2) +
labs(title="A",x="", y = "Weekly iNTS incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,60)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox2 <- ggplot(subset(case.iNTS, year(date)<2011), aes(x=month(date), y=case_count_obs))  +
geom_boxplot(aes( group=month(date)), color="tan4", fill="tan4", alpha=0.2) +
labs(title="B",x="", y = "Monthly iNTS incidence") +
scale_x_discrete(limits = i) +
ylim(c(0,200)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
View(case.iNTS)
j <- seq(from=1, to=53, by=4)
i <- seq(from=1, to=12, by=1)
pox1 <- ggplot(subset(case.iNTSW, year(date)<2011), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)),color="tan4", fill="tan4", alpha=0.2) +
labs(title="A",x="", y = "Weekly iNTS incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,60)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox2 <- ggplot(subset(case.iNTS, year(date)<2011), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="tan4", fill="tan4", alpha=0.2) +
labs(title="B",x="", y = "Monthly iNTS incidence") +
scale_x_discrete(limits = i) +
ylim(c(0,200)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox3 <- ggplot(subset(case.typhiW, year(date)>2010), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)), color="red4", fill="red", alpha=0.2) +
labs(title="C", x="", y = "Weekly typhoid incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,40)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox4 <- ggplot(subset(case.typhi, year(date)>2010), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="red4", fill="red", alpha=0.2) +
labs(title="D", x="", y = "Monthly typhoid incidence") +
scale_x_discrete(limits =i) +
ylim(c(0,125)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
grid.arrange(grobs=list(pox1, pox2, pox3, pox4), ncol=2, nrow=2)
ggplot(subset(case.iNTSW, year(date)<2011), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)),color="tan4", fill="tan4", alpha=0.2) +
labs(title="A",x="", y = "Weekly iNTS incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,60)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
ggplot(subset(case.iNTSW, year(date)<2011), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)),color="tan4", fill="tan4", alpha=0.2) +
labs(title="A",x="", y = "Weekly iNTS incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,5)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
ggplot(subset(case.iNTSW, year(date)<2011), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)),color="tan4", fill="tan4", alpha=0.2) +
labs(title="A",x="", y = "Weekly iNTS incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,10)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
ggplot(subset(case.iNTSW, year(date)<2011), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)),color="tan4", fill="tan4", alpha=0.2) +
labs(title="A",x="", y = "Weekly iNTS incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
ggplot(subset(case.iNTS, year(date)<2011), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="tan4", fill="tan4", alpha=0.2) +
labs(title="B",x="", y = "Monthly iNTS incidence") +
scale_x_discrete(limits = i) +
ylim(c(0,200)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
ggplot(subset(case.iNTS, year(date)<2011), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="tan4", fill="tan4", alpha=0.2) +
labs(title="B",x="", y = "Monthly iNTS incidence") +
scale_x_discrete(limits = i) +
ylim(c(0,30)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
ggplot(subset(case.iNTS, year(date)<2011), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="tan4", fill="tan4", alpha=0.2) +
labs(title="B",x="", y = "Monthly iNTS incidence") +
scale_x_discrete(limits = i) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
ggplot(subset(case.typhiW, year(date)>2010), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)), color="red4", fill="red", alpha=0.2) +
labs(title="C", x="", y = "Weekly typhoid incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,40)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
ggplot(subset(case.typhiW, year(date)>2010), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)), color="red4", fill="red", alpha=0.2) +
labs(title="C", x="", y = "Weekly typhoid incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
ggplot(subset(case.typhi, year(date)>2010), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="red4", fill="red", alpha=0.2) +
labs(title="D", x="", y = "Monthly typhoid incidence") +
scale_x_discrete(limits =i) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox1 <- ggplot(subset(case.iNTSW, year(date)<2011), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)),color="tan4", fill="tan4", alpha=0.2) +
labs(title="A",x="", y = "Weekly iNTS incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox2 <- ggplot(subset(case.iNTS, year(date)<2011), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="tan4", fill="tan4", alpha=0.2) +
labs(title="B",x="", y = "Monthly iNTS incidence") +
scale_x_discrete(limits = i) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox3 <- ggplot(subset(case.typhiW, year(date)>2010), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)), color="red4", fill="red", alpha=0.2) +
labs(title="C", x="", y = "Weekly typhoid incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox4 <- ggplot(subset(case.typhi, year(date)>2010), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="red4", fill="red", alpha=0.2) +
labs(title="D", x="", y = "Monthly typhoid incidence") +
scale_x_discrete(limits =i) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
grid.arrange(grobs=list(pox1, pox2, pox3, pox4), ncol=2, nrow=2)
ggplot(subset(case.iNTSW, year(date)<2011), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)),color="orange2", fill="orange2", alpha=0.2) +
labs(title="A",x="", y = "Weekly iNTS incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
ggplot(subset(case.typhiW, year(date)>2010), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)), color="red2", fill="re2", alpha=0.2) +
labs(title="C", x="", y = "Weekly typhoid incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
ggplot(subset(case.typhiW, year(date)>2010), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)), color="red2", fill="red2", alpha=0.2) +
labs(title="C", x="", y = "Weekly typhoid incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox1 <- ggplot(subset(case.iNTSW, year(date)<2011), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)),color="orange2", fill="orange2", alpha=0.2) +
labs(title="A",x="", y = "Weekly iNTS incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox2 <- ggplot(subset(case.iNTS, year(date)<2011), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="orange2", fill="orange2", alpha=0.2) +
labs(title="B",x="", y = "Monthly iNTS incidence") +
scale_x_discrete(limits = i) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox3 <- ggplot(subset(case.typhiW, year(date)>2010), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)), color="red2", fill="red2", alpha=0.2) +
labs(title="C", x="", y = "Weekly typhoid incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox4 <- ggplot(subset(case.typhi, year(date)>2010), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="red2", fill="re2", alpha=0.2) +
labs(title="D", x="", y = "Monthly typhoid incidence") +
scale_x_discrete(limits =i) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
grid.arrange(grobs=list(pox1, pox2, pox3, pox4), ncol=2, nrow=2)
pox1 <- ggplot(subset(case.iNTSW, year(date)<2011), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)),color="orange2", fill="orange2", alpha=0.2) +
labs(title="A",x="", y = "Weekly iNTS incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox2 <- ggplot(subset(case.iNTS, year(date)<2011), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="orange2", fill="orange2", alpha=0.2) +
labs(title="B",x="", y = "Monthly iNTS incidence") +
scale_x_discrete(limits = i) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox3 <- ggplot(subset(case.typhiW, year(date)>2010), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)), color="red2", fill="red2", alpha=0.2) +
labs(title="C", x="", y = "Weekly typhoid incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox4 <- ggplot(subset(case.typhi, year(date)>2010), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="red2", fill="red2", alpha=0.2) +
labs(title="D", x="", y = "Monthly typhoid incidence") +
scale_x_discrete(limits =i) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
grid.arrange(grobs=list(pox1, pox2, pox3, pox4), ncol=2, nrow=2)
pox3 <- ggplot(subset(case.typhiW, year(date)>2010), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)), color="red2", fill="red2", alpha=0.2) +
labs(title="C", x="Weeks (Jan-Dec)", y = "Weekly typhoid incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox4 <- ggplot(subset(case.typhi, year(date)>2010), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="red2", fill="red2", alpha=0.2) +
labs(title="D", x="Months (Jan-Dec)", y = "Monthly typhoid incidence") +
scale_x_discrete(limits =i) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
grid.arrange(grobs=list(pox1, pox2, pox3, pox4), ncol=2, nrow=2)
pox1 <- ggplot(subset(case.iNTSW, year(date)<2011), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)),color="orange2", fill="orange2", alpha=0.2) +
labs(title="A",x="Weeks (Jan-Dec)", y = "Weekly iNTS incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox2 <- ggplot(subset(case.iNTS, year(date)<2011), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="orange2", fill="orange2", alpha=0.2) +
labs(title="B",x="Months (Jan-Dec)", y = "Monthly iNTS incidence") +
scale_x_discrete(limits = i) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox3 <- ggplot(subset(case.typhiW, year(date)>2010), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)), color="red2", fill="red2", alpha=0.2) +
labs(title="C", x="Weeks (Jan-Dec)", y = "Weekly typhoid incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox4 <- ggplot(subset(case.typhi, year(date)>2010), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="red2", fill="red2", alpha=0.2) +
labs(title="D", x="Months (Jan-Dec)", y = "Monthly typhoid incidence") +
scale_x_discrete(limits =i) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
grid.arrange(grobs=list(pox1, pox2, pox3, pox4), ncol=2, nrow=2)
pox1 <- ggplot(subset(case.iNTSW, year(date)<2011), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)),color="orange2", fill="orange2", alpha=0.2) +
labs(title="A",x="Week (Jan-Dec)", y = "Weekly iNTS incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox2 <- ggplot(subset(case.iNTS, year(date)<2011), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="orange2", fill="orange2", alpha=0.2) +
labs(title="B",x="Month (Jan-Dec)", y = "Monthly iNTS incidence") +
scale_x_discrete(limits = i) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox3 <- ggplot(subset(case.typhiW, year(date)>2010), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)), color="red2", fill="red2", alpha=0.2) +
labs(title="C", x="Week (Jan-Dec)", y = "Weekly typhoid incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,6)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox4 <- ggplot(subset(case.typhi, year(date)>2010), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="red2", fill="red2", alpha=0.2) +
labs(title="D", x="Month (Jan-Dec)", y = "Monthly typhoid incidence") +
scale_x_discrete(limits =i) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
grid.arrange(grobs=list(pox1, pox2, pox3, pox4), ncol=2, nrow=2)
pox1 <- ggplot(subset(case.iNTSW, year(date)<2011), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)),color="orange2", fill="orange2", alpha=0.2) +
labs(title="A",x="Week (Jan-Dec)", y = "Weekly iNTS incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox2 <- ggplot(subset(case.iNTS, year(date)<2011), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="orange2", fill="orange2", alpha=0.2) +
labs(title="B",x="Month (Jan-Dec)", y = "Monthly iNTS incidence") +
scale_x_discrete(limits = i) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox3 <- ggplot(subset(case.typhiW, year(date)>2010), aes(x=week(date), y=incid_obs))  +
geom_boxplot(aes( group=week(date)), color="red2", fill="red2", alpha=0.2) +
labs(title="C", x="Week (Jan-Dec)", y = "Weekly typhoid incidence") +
scale_x_discrete(limits = j) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
pox4 <- ggplot(subset(case.typhi, year(date)>2010), aes(x=month(date), y=incid_obs))  +
geom_boxplot(aes( group=month(date)), color="red2", fill="red2", alpha=0.2) +
labs(title="D", x="Month (Jan-Dec)", y = "Monthly typhoid incidence") +
scale_x_discrete(limits =i) +
ylim(c(0,25)) +
theme(axis.title.y = element_text(size = 11)) +
theme(axis.title.x = element_text(size = 11)) +
theme(axis.text.x = element_text(face="bold", size=11), axis.text.y = element_text(face="bold", size=11))
grid.arrange(grobs=list(pox1, pox2, pox3, pox4), ncol=2, nrow=2)
